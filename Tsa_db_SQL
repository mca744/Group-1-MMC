IF NOT EXISTS(SELECT * FROM sys.databases WHERE name='TSA_DW')
BEGIN
CREATE DATABASE [TSA_DW]
END;
GO

USE [TSA_DW];
GO

CREATE SCHEMA [TSA];
GO

CREATE  TABLE [TSA_DW].TSA.AirportDimension ( 
	[airport id]         int      NOT NULL,
	[airport code]       varchar(3)      NULL,
	[airport name]       varchar(100)      NULL,
	city                 varchar(100)      NULL,
	state                varchar(100)      NULL,
	latitude             decimal      NULL,
	longitude            decimal      NULL,
	[checkpoint]         varchar(50)      NULL,
	CONSTRAINT [pk AirportDimension] PRIMARY KEY  ( [airport id] ) 
 );
GO

CREATE  TABLE [TSA_DW].TSA.DateDimensions ( 
	[hour date id]       int      NOT NULL,
	date                 date      NULL,
	[hour of day]        datetime      NULL,
	[day of week]        varchar(10)      NULL,
	month                varchar(10)      NULL,
	year                 int      NULL,
	CONSTRAINT [pk Entity] PRIMARY KEY  ( [hour date id] ) 
 );
GO

CREATE  TABLE [TSA_DW].TSA.FactTable ( 
	[fact Id]            int      NOT NULL,
	temperature          decimal      NULL,
	humidity             decimal      NULL,
	[apparent temperature] decimal      NULL,
	[precipitation rain] decimal      NULL,
	rain                 decimal      NULL,
	snowfall             decimal      NULL,
	[snow depth]         decimal      NULL,
	[cloud cover total]  decimal      NULL,
	[wind speed]         decimal      NULL,
	[wind direction]     varchar(20)      NULL,
	[hour date id]       int      NOT NULL,
	[airport id]         int      NOT NULL,
	[total pax]          numeric      NULL,
	CONSTRAINT [pk FactTable] PRIMARY KEY  ( [fact Id], [hour date id], [airport id] ) 
 );
GO

ALTER TABLE [TSA_DW].TSA.FactTable ADD CONSTRAINT [fk FactTable DateDimensions] FOREIGN KEY ( [hour date id] ) REFERENCES [TSA ].INSTANCE.DateDimensions( [hour date id] );
GO

ALTER TABLE [TSA_DW].TSA.FactTable ADD CONSTRAINT [fk FactTable AirportDimension] FOREIGN KEY ( [airport id] ) REFERENCES [TSA ].INSTANCE.AirportDimension( [airport id] );
GO
